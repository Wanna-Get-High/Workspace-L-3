package editor;

import java.util.ArrayList;
import java.util.List;

import javax.swing.JFrame;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JTextArea;

import application.extensions.PluginChecker;
import application.extensions.PluginEvent;
import application.extensions.PluginListener;




public class Editor
{
	protected JFrame frame;
	protected JTextArea text;
	protected JMenuBar menuBar;
	protected JMenu plugins;
	
	protected PluginChecker checker;
	
	public Editor(String repExt)
	{
		this.checker = new PluginChecker(500, repExt);
		this.checker.addPluginListener(new OutilsListener());
		
		this.frame = new JFrame("Plugin");
		this.menuBar = new JMenuBar();
		this.plugins = new JMenu("Plugin");
		this.menuBar.add(this.plugins);
		
		this.text  = new JTextArea(20,40);
		
		this.frame.setJMenuBar(this.menuBar);
		this.frame.add(this.text);
		this.frame.pack();
		this.frame.setVisible(true);
		this.frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
	}


	
	public static void main(String[] args) 
	{
		Editor e = new Editor(args[0]);
		e.checker.createChecker();
	}
	
	/**
	 * subClasse 
	 * @author franziz
	 *
	 */
	class OutilsListener implements PluginListener
	{
		int i = 0;
		List<JMenuItem> items = new ArrayList<JMenuItem>();
		@Override
		public void pluginAdded(PluginEvent e) 
		{
			this.items.add(new JMenuItem(e.getExtention().substring(0, e.getExtention().length()-6)));
			Editor.this.plugins.add(this.items.get(i));
			this.items.get(i).addActionListener(new ActionListener(){
				@Override
				public void actionPerformed(ActionEvent arg0) {
					area.setText(ext.transformer(area.getText()));
				}});
			i++;
		}

		@Override
		public void pluginRemoved(PluginEvent e)
		{
			Editor.this.plugins.remove(this.items.get(i-1));
			this.items.remove(this.items.get(i-1));
			i--;
			//System.out.println("<-- plugin removed : "+e.getExtention());
			//on chope le nom via e.getExtentions();
			// et on retire un JMeniuItem ac le nom corespondant		
		}
	}
}